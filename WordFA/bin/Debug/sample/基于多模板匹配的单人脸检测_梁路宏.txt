第4卷( A版)　第10期
1999年10月
中国图象图形学报
Jo urnal of Image a nd Graphics 
Vol. 4( A) , No. 10 
Oct. 1999 
* 本文研究受清华大学青年科学基金及国家“ 863”高科技计划( No. 980311096)资助
收稿日期: 1999-03-04; 收到修改稿日期: 1999-07-26 
基于多模板匹配的单人脸检测* 
梁路宏　艾海舟　何克忠
(清华大学计算机科学与技术系智能技术与系统国家重点实验室, 北京　100084) 
摘　要　提出了一种基于多模板匹配的一般环境图象中单人脸的检测方法。首先用双眼模板初步筛选,然后使用具
有不同长宽比的多个人脸模板进行检测和定位,最后利用人脸器官的边缘特征进行确认。采用以固定比率压缩输入
图象的方法解决不同尺度人脸的检测问题。实验表明这种方法具有较高的速度和检测成功率。
关键词　模板匹配　人脸识别　人脸检测
0　引　言
人脸识别的研究最近几年再度受到普遍重视,它
与指纹识别、视网膜识别等同属于生物特征识别技术
范畴,在诸如安全检查、保安管理等方面有着十分重
要的应用价值。浏览各种文献可以发现,对于人脸识
别算法的研究已经相当深入[1 ] ,但对于如何检测人脸
或输入人脸的研究近几年才受到重视。这是因为过去
的人脸识别研究主要针对具有较强约束条件的人脸
图象(如无背景) ,往往假设人脸的位置已知或很容易
获得; 近几年来,电子商务等网络资源的利用使得人
脸识别成为最有潜力的生物身份验证手段,在这种应
用背景下,人脸检测作为一个单独的课题开始受到研
究者的重视。此外,人脸检测在基于内容的检索、多模
态人机接口、智能监视等方面也有着重要的应用价
值,这使得人脸检测的研究倍受关注。从学术观点来
看,人脸检测的挑战性意义在于人脸是自然界中构成
和细节变化最复杂的模式之一,如果能够研究出一个
成功的人脸检测系统,那么就可以对其它相似特征或
模式的检测问题提供有价值的参考[2 ]。
本文所研究的是一般环境图象中单个正面端正
人脸的检测问题。这种条件下的人脸检测的方法主
要有模板匹配方法[3 ]、可变形模板方法[ 4]、镶嵌图方
法[5 ]、基于统计特征的方法[6 ]以及基于人工神经网
的方法[2 ]等。概括地说,基于模板匹配的方法是在图
象灰度的层次上直接比较目标模板和候选图象区域
之间的相似性,而基于特征的匹配方法是比较从图
象中抽取的一定特征的相似性,对人脸检测而言,特
征包括眼睛、鼻、嘴等。模板匹配方法具有简单、直观
的特点,与特征匹配方法相比具有较强的适应性,原
因在于通常特征抽取依赖于图象的质量,易受噪音
影响而不稳定。
本文提出了一种基于多模板匹配的单人脸检测
方法,其中用到两种模板: 双眼模板和不同长宽比的
人脸模板。在检测时首先使用双眼模板进行粗筛选, 
然后使用不同长宽比的人脸模板确定出人脸区域的
位置和范围,最后利用人脸器官的边缘特征进行确
认。为了解决图象中不同尺度人脸的检测问题,采用
了按照固定比率逐步缩小输入图象的方法进行多个
尺度上的搜索。实验表明该方法在162幅单人头部图
象(包括简单背景和复杂背景)中检测人脸的成功率
可以达到94. 4% ; 在55幅较清晰的单人半身图象中
检测人脸的成功率也达到了81. 8% 。
1　模板生成
我们在人脸检测中使用了6个模板: 一个用于初
筛选的双眼模板, 5个用于检测的不同长宽比的人脸
模板。采用多个人脸模板是为了适应不同人脸部的
不同长宽比。模板是通过对多个样本取平均构造出
来的,如图1所示,首先在选取的样本图象上用手工
划出人脸的区域作为人脸样本。由于各个样本的尺
度大小和灰度分布各不相同,因此先对它们进行尺
度和灰度分布标准化,然后将所有样本取灰度平均
并压缩到需要的尺度作为原始模板。拷贝原始模板
的眼睛部分,进行灰度分布标准化后作为双眼模板; 
对原始模板分别按照1 0. 9、1 1、1 1. 1、1 1. 2和1 

1. 3的宽长比变形,进行灰度分布标准化后作为人脸模板。
图1　模板生成的过程
　　在模板生成中最主要的工作是图象的尺度变换
和灰度分布标准化。尺度变换采用了基于线性插值
的重采样方法,这里不再具体讨论。我们考虑了表征
图象灰度分布的两个参量―― 灰度的平均值和方
差,将它们调整到给定值,以消除由于采集时光照等
因素对人脸图象的影响。对于模板匹配,我们认为这
种灰度分布标准化方法比常用的直方图均衡化方法
更有效,原因在于它将均值和方差这两个关键数字
特征一致化了。
将图象看作一个二维矩阵D [W ] [H ],其中W 和
H 为图象的宽和高,则该图象的灰度平均值可表示为: 
_- = 
1 
W HΣW- 1 
i= 0ΣH- 1 
j= 0 
D [i ] [ j ] ( 1) 
　　而灰度分布的方差可表示为: 
e-2 = 
1 
W HΣW- 1 
i= 0ΣH- 1 
j= 0 
(D [i ] [j ] - _-) 2 ( 2) 
　　对于输入的每个样本图象,为了将其灰度平均值
和方差变换到事先设定的灰度平均值_ 0和方差e0 , 
对样本中的每个象素点的灰度值进行如下的变换: 
D [i ] [ j ] = 
e0e
- ( D [i ] [j ] - _-) + _ 0 
0≤ i < W , 0≤ j < H ( 3) 
　　公式( 3)是一种近似算法,效果参见图1。实验中
我们手工提取了40个人脸样本,通过以上方法得到
一个尺度为24× 9象素的双眼模板和尺度分别为24 
× 21、24× 24、24× 26、24× 28、24× 31象素的5个人
脸模板。为了保证采集和求平均时人脸样本之间能
够对准,我们在构造模板的过程中首先将样本标准
化到50× 50,求平均后再压缩到需要的大小。
2　检测方法
假设人脸模板的灰度矩阵为T [M ] [N ] ,灰度
均值为_ T ,均方差为eT ,输入图象区域的灰度矩阵
为R [M ] [N ],灰度均值为_ R ,均方差为eR ,那么它
们之间的相关系数r ( T , R )和对应象素灰度值的平
均偏差d ( T, R )分别为: 
r ( T, R ) = 
ΣM- 1 
i= 0ΣN - 1 
j= 0 
( T [i ] [ j ] - _ T ) ( R [i ] [ j ] - _ R ) 
M N eT eR 
( 4) 
d ( T, R ) = 
ΣM- 1 
i= 0ΣN - 1 
j= 0 
( T [i ] [j ] - R [i ] [j ] ) 2 
M N 
( 5) 
　　r ( T , R )越大表示模板与输入图象区域的匹配
程度越高;而d ( T, R )正相反。将它们综合起来作为
匹配程度的度量: 
D( T, R ) = r( T, R ) + T 
1+ d ( T, R ) 
( 6) 
其中T为权重系数,我们取经验值T= 35. 0,它是根据实
验数据使前后两部分的量值相当而取定的平均当量。
作为辅助手段,我们采用人脸器官边缘特征的
分布规则作为进一步确认的方法,排除一些错检,提
高检测率。首先对待检测区域使用Sobel算子获得
梯度图象,然后进行灰度分布标准化,最后二值化得
到边缘图象。由于人脸边缘图象的细节受光照、面部
表情等因素的影响很大,我们采用统计的方法来提
高鲁棒性: 根据人脸部器官分布特点,将边缘图象划
分成3× 3个相同大小的块,统计整个图象和每一块
826 中国图象图形学报第4卷( A版)

中边缘点所占的比例,如图2所示。
使用比较弱的经验规则,仅对双眼、鼻子和嘴的
边缘统计特征进行检验。设3× 3块中边缘点的比例为
R [m , n ] (其中0≤m≤ 2, 0≤ n≤ 2) , 编号排列如图2 
( e) ,整个区域中边缘点所占比例为R - 
,若该区域是人
脸则应满足规则: ( 1) 0. 16 <R - 
< 0. 30; ( 2) R [ 0, 0 ] 
> 0. 7R - 
且R [0, 2 ] > 0. 7R - 
; ( 3) R [ 1, 1 ]> 0; 
( 4) R [2, 1]> 0. 5R - 
。
( a) 梯度图象度分布标准化后的图象c) 二值化后的图象d)分块统计边缘点
0, 0 0, 1 0, 2 
1, 0 1, 1 1, 2 
2, 0 2, 1 2, 2 
( e)分块统计边缘点
图2　利用边缘特征判别
3　算法实现
算法的基本思路是: 搜索输入图象中所有可能为
人脸的区域,认为满足一定条件且与模板匹配程度最
高的区域是人脸。为了检测不同尺度的人脸,采用按
固定比率(如1 /1. 1倍)反复压缩输入图象,在压缩后
的图象中进行检查的方法; 为了检测不同长宽比的人
脸,采用前述5种不同长宽比的模板进行匹配。
假设输入图象中最多只有一个完整的人脸(正
面、端正) ,可能的人脸宽度在24象素(人脸的最小分
辨尺度为16× 16[7 ] ,考虑到模板匹配的准确性,取最
小宽度为24)到图象宽度的1 /2之间, 人脸的位置未
知。设输入图象为IS (宽W、高H) ;双眼模板为TEyes , 
5个人脸模板为TFace [i ] ( 1≤ i≤ 5) ,其宽度为24、高度
分别为HFace= { 21, 24, 26, 28, 31}。算法如下: 
① 初始化最大匹配度Dmax= 0,设定当前图象
IC= IS ; 
② 对图象IC 使用So bel算子得到梯度图象
Igra d ,令当前图象的宽w= W、高h= H; 
③ 设当前扫描点(x , y )为图象起始点( 0, 0) ; 
④ 检测区域REyes ( x , y , x+ 24, y+ 9)是否为双
眼,若不是则转⑦ ; 
⑤ 检测相应区域是否为人脸,是则求出当前区
域与人脸模板的匹配度D,否则转⑦ ; 
⑥ 若D> Dmax , 记录当前区域的位置和大小
(换算为输入图象IS 中的坐标)并令Dmax= D; 
⑦ 若x+ 24 <W , x= x+ 1,转④ ; 
⑧ 若y+ 31 < H, x= 0, y= y+ 1,转④ ; 
⑨ 若w> 48,对图象IC 使用线性插值重采样
法缩小1 /1. 1倍,修改w 和h ,转③ ; 
10 左右颠倒输入图象,设定为当前图象IC ,重
复②― ⑨ ; 
1 输出检测结果,结束。
其中步骤④、⑤的详细过程见图3。
计算区域REy es的灰度值均方差DEy es 
DE yes > 20? 
否
不是人脸
是
对RE yes进行灰度分布标准化; 
计算RE yes 的对称性SE yes 
是
S Eye s < 60? 
否
计算RE yes与模板TEy es的相关系数R Eyes 
是
RE yes > 0. 3? 
否
是
初始化i = 1; D = - ∞ 
拷贝区域RFace ( x , y, x + 24, y + HFace [ i ] ) ; 
进行灰度分布标准化; 
求与TF ace [i ]的匹配度DFace 
DFace > D? 
是
D = DFace记录R = RFace 
i < 5? 
是
i = i+ 1 
否
检查R 在图象Igrad 中的
相应区域是否满足边缘规则
DFace > 1. 1且
满足边缘规则? 
否
是
可能是人脸
图3　步骤④、⑤的流程
第 10期 梁路宏等:基于多模板匹配的单人脸检测 827

　　图3中双眼区域的对称性检查是基于一般人脸
(正面、端正)的双眼左右对称这一先验知识进行的, 
度量指标SEyes是区域中所有左右相对的象素间灰度
值的平均偏差。在使用双眼模板匹配前先对可能为双
眼的区域进行灰度值均方差和对称性的检查,可以提
前“淘汰”不可能为双眼的区域,从而提高检测速度。
我们使用的双眼和人脸模板是左右非对称的, 
因此在算法的步骤10中左右颠倒输入图象后再进行
次检测,以防止漏检。
4　实验结果
我们使用了两类包含单个人脸(正面、端正)的
图象: 头部图象共162幅,包括30幅MI T图象库中的
简单和复杂背景图象、33幅摄像机采集的图象、61幅
扫描的证件照以及38幅其它来源的照片; 半身图象
共55幅,包括13幅摄像机采集的图象、32幅扫描的普
通照片和从Internet上下载的艺术照。
我们采用4种不同的方法对上述两类图象进行
检测: ( 1) 使用相关系数(公式( 4) )衡量匹配程度; 
( 2) 使用平均偏差(公式( 6) )衡量匹配程度; ( 3) 使
用相关系数和平均偏差的加权和(公式( 7) )衡量匹
配程度; ( 4) 使用加权和衡量匹配程度并用边缘特
征确认。其中方法( 4)完全采用图3所示流程, 方法
( 1)― ( 3)仅采用了图3流程的一部分。我们假设已知
人脸的大致尺度,将检测的尺度范围限定为图象中
人脸实际尺度的约70%到130%之间。这样在检测时
仅需在4― 6种尺度上进行搜索,减小了计算量,同时
一定程度上降低了检测的难度。
使用不同方法检测的正确率见表1。每幅图象检
测所用时间从6秒(头部图象)到35秒(半身图象)不
等( PentiumⅡ 350 CPU、128MB内存)。可以看到, 
我们使用的相关系数与平均偏差加权和的方法优于
单独使用相关系数或平均偏差,而且使用边缘特征
确认可以提高检测正确率。总体而言,我们提出的算
法是有效的。
表1　使用不同方法的检测正确率
照片类型
方　法
相关系数平均偏差加权和加权和+ 边缘确认
头部图象
( 111人, 162幅) 
88. 9% 
(正确144幅、错误18幅) 
88. 9% 
(正确144幅、错误18幅) 
91. 4% 
(正确148幅、错误14幅) 
94. 4% 
(正确153幅、错误8幅、漏检1幅) 
半身图象
( 29人, 55幅) 
74. 5% 
(正确41幅、错误14幅) 
76. 4% 
(正确42幅、错误13幅) 
78. 2% 
(正确43幅、错误12幅) 
81. 8% 
(正确45幅、错误10幅) 
　　图4是部分头部图象的检测结果,从图中可以看
到,该方法对于戴眼镜的情况(左1、左3)仍有一定适
应性,尽管检测用的模板没有考虑戴眼镜及有胡须
等特殊情况。
图5是对M IT复杂背景人脸图象库中的头部图
象检测的部分结果。除最后一幅检测错误外,均能得
到正确的结果,由此可见该算法在复杂背景的情况
下仍然是有效的。
图4　头部图象中检测的部分结果
图5　MIT复杂背景人脸图象中检测的结果
828 中国图象图形学报第4卷( A版)

　　图6是部分半身照检测的结果。可以看到,本文
的方法对于人脸在图象中相对较小且背景比较复杂
情况下的检测仍然有效。但总体而言,这种情况下的
检测正确率比头部图象低。这主要是因为图象的范
围越大,背景越复杂,则出现类似于人脸的模式的概
率越大。
　　( a) 摄像机获取的图象　　　　　　　　　( b) 扫描的普通照片　　　　　　　( c) In ternet上下载的艺术照
图6　单人生活照中检测的部分结果
6　总　结
我们主要研究了静态图象中单人脸的检测算
法,由于算法主要是依靠双眼模板和脸部模板来检
测、定位的,因此受模板类型的限制,该算法的适用
范围是正面端正的单人脸,所谓正面端正的含义是
指双眼在图中均可见而且应大致在同一水平线上。
这种约束对于人脸的自动识别系统以及某些基于内
容的检索系统是可以接受的,因而这种方法有很大
的应用价值。
我们针对满足上述限定条件的大量人脸图象进
行了实验。对于类似证件照的头部图象(包括简单背
景和复杂背景) ,检测的正确率达到94. 4% ; 对于质
量较好的半身图象,检测的正确率也可达到81. 8%。
实验结果是令人满意的。
我们的算法也存在一些缺陷。首先是对于人脸
的背景较多且复杂情况下检测的错误率较高。这一
方面是由于自然界的物体千变万化,在人脸图象中
很可能存在某一或几方面特征类似人脸的模式; 另
一方面是由于人脸图象(模板)本身不能直接反映人
脸的本质特征,由模板代表的人脸模式的紧致性并
不好。另外,我们的算法虽然采取了一些提高检测速
度的措施,但仍有许多方面没有考虑,如多尺度搜索
中不同尺度图象间已有信息的利用等。这些都有待
于将来进一步研究。
参考文献
1　Ch el lappa R, Wils on C L, Si roh ey S. Human and machine 
recog ni ti on of faces: A su rv ey. In: Proc of th e IEEE, 1995, 83 
( 5): 705～ 740. 
2　Sung K, Poggio T. Ex am ple-bas ed learning f or vi ew -bas ed h um 
an f ace detecti on, IE EE Trans Pat t ern Anal ysis and Machine 
In tellig ence, 1998, 20( 1): 39～ 51. 
3　Brunel li R, Poggio T. Face recogniti on: Features versu s templ 
ates, IEE E Trans Pat t ern Anal ysis and Machine Int elligence, 
1993, 15( 10): 1042～ 1052. 
4　Yuil le A, Hallinan P, Cohen D. Feature ext racti on f rom f aces 
using def ormabl e t emplat es. Int J Comp ut er Visi on, 1992, 8( 2): 
99～ 111. 
5　Yang G Z, Huang T S. Human f ace detect ion in a compl ex backg 
round. Pat t ern Recogni tion , 1994, 27( 1): 53～ 63. 
6　Rowl ey H A, Balu ja S, Kanade T. Neural netw ork-based face 
d et ecti on. IEE E Trans Pat tern Anal ysi s and Mach ine Int ellig 
ence, 1998, 20( 1): 23～ 38. 
7　Samal A, Iyengar P A. Au tomati c recog ni ti on and analysis of 
h uman f aces and f acial expres sion: A s urvey. Pat t ern Recog nition 
Soci et y, 1992, 25( 1): 65～ 67. 
　　　梁路宏　1997年获得清华大学计算
机系学士学位,现为清华大学计算机系
博士生。研究方向是计算机视觉与模式
识别。
第 10期 梁路宏等:基于多模板匹配的单人脸检测 829

　　　艾海舟　1985、1988、1991年分别获
得清华大学计算机应用专业学士、硕士、
博士学位,毕业后留校任教, 1994― 1996 
年为比利时布鲁塞尔自由大学博士后, 
现为清华大学计算机系副教。主要从事
计算机视觉、模式识别、移动机器人技术
的研究,发表论文20余篇。
　　　何克忠　清华大学计算机系教授, 
1962年毕业于清华大学自动控制系。主
要从事计算机控制、智能移动机器人技
术的研究,先后主持研制了智能移动机
器人T HMR-Ⅰ 、T HMR-Ⅱ 、T HM R-Ⅲ , 
多次获部委科技进步奖,出版专著3部, 
发表论文40余篇。
Mult i-Template-Matching-Based Single Face Detect ion 
Lia ng Luho ng , Ai Hai zhou a nd He Keho ng 
(Comp uter Depa rtment of Tsing hua Uni versit y, State Key Labor atory of Intel l igen t Technology an d Systems , Bei j ing 100084) 
Abstract　This pa per dev elops a multi-templa te-ma tching-based method fo r sing le face detectio n in genera l backg ro und images. 
Firstly tw o-eyes-in-who le template is used fo r determining the potentia l location of the face ro ughly. Seco ndly 5 who le 
face templa tes with different w idth-heig ht r atio s ar e used for searching and localizatio n. Finally some edge fea tures ar e used 
fo r v erifying the detection results. Input imag e is r esampled via co nsta nt ratio in o rder to deal with the pr oblem o f m ulti-sca le 
detectio n. Experiment r esults show tha t it is relativ ely fast and rather successful. 
Keywords　Template ma tching , Face r eco gnition, Face detectio n 
Creative推介Sound Blaster Live! Digital数码版
1999年9月27日Creativ e Tech no lo gy Ltd. ( N ASDAQ: CREAF) ,在个人娱乐多媒体解决方案领域中的领导者,宣布
Sound Bla ster○R Liv e! Digital数码版声卡将于今天面世。此款声卡集各项优势于一身,让网络音乐爱好者可以自如地以CD音
质创作、编排与播放M P3音乐及其它音频文件。Sound Blaster Live! 数码版还有一项别具一格的视频动画技术― LAV A! TM 
( Liv e Audio Visua l Anima tio n) ,其实时产生的动画对MP3音乐和其它网络音乐文件起到了很好的视听丰富作用。
So und Blaster Liv e! 数码版是基于去年一经推出便屡获殊荣、成为业界标准的Sound Blaster Liv e! 。So und Blaster Liv e! 
数码版采用强劲的EM U10K1TM音频处理器,使得不论是音乐爱好者或是音乐家都可以方便地以数码到数码处理方式创作音
乐。创作出的音质可媲美录音室,同时也能播放MP3、M IDI、W AV、Inte rnet及CD音频文件。Sound Blaster Liv e! 数码版的用
户们也可以轻松地从他们的CD藏品中抓取音轨并转换为M P3格式的文件,在PC上存储和播放。
LAV A! 使网络音乐呈现出全新形象,使用者可通过它创造出引人入胜的视觉拼接效果,使网络音乐更具活力,例如伴随
着M P3音乐同步播放的3D图象。LAV A! 播放器最近于Woodstock 99摇滚音乐节上首度推出,它可根据音乐的不同频率做出
回应、实时产生出图象,从而创造出了即时3D音乐录象。
LAV A! 占用的硬盘空间不足100KB。使用者可在8种不同的模板中进行选择,然后对LAV A! 文件进行自定义设置,许多
元素如乐队标志、封套设计及说明文字都可自行编辑。在应用到M P3文件后,集音乐图象于一身的一体化文件就可以发给亲
朋好友或放置在某个站点供下载或观看。LAV A! 由Creativ e-Em u技术中心开发,同时采用了技术先进的音频分析和硬件图
形加速,从而诞生出了可应用于网络音乐应用程序的全新视觉语言。
So und Blaster Liv e! Digital数码版的主要特性 
EMU10K1数码信号处理器: 完全32位的音频信号处理能力,提供极为纯净的声音和极为精确的3D定位音效。数码输出
插孔可用于Cr eativ e Fo urPoint Sur ro undT M FPS2000D数码音箱系统的纯数码式连接。 
Creativ e数码音频中心软件: 用户使用它可以对M P3文件进行编码、解码或归档处理,还可以从个人CD藏品中将大量
的CD音轨转换为M P3文件并归类编排目录。数码音频中心软件还捆绑有下列软件: Mixma n○R , Ca kew alkEx pr ess○R , So und 
Fo rg e○R , Media Ring Talk○R '99。
(下转第834页) 
830 中国图象图形学报第4卷( A版)

